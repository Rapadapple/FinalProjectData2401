---
title: "Data2401Final"
author: "Kevin Sheard"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(ggplot2)
```

```{r}
energy = read_csv("archive/organised_Gen.csv")
```


```{r}
colnames(energy) = c("ID", "year", "month", "state", "producer", "source", "generation")
energy = energy %>% select(-`ID`)

energy
```

#
What is a producer? Type of producers are Companys and utilities that generate energy from Total final energy consumption (TFEC). Total final energy consumption (TFEC) is found by multiplying the power use (in kilowatts, kW) by the number of hours during which the power is consumed. Multiply that value by the cost per kWh, and you have the total energy cost. Final or available energy is the energy delivered to consumers for end consumption (petrol at the pump, electricity in the household, etc.).

The Type of producer category has 6 categories that classify the energy generation and that are going to be used to analyze the effect and importance of each one.  

```{r}
energy %>% count(producer)

energy %>% count(source)

#Texas Power Dist
energy %>% 
  filter(producer != "Total Electric Power Industry", state == 'TX', source != 'Total') %>%
  ggplot() + 
  geom_col(aes(x = producer, y = generation, fill = source)) +
  labs(title = "TX Power Distribution") +
  theme(axis.text.x = element_text(angle = -25, vjust = .5, hjust = .1))

#US Power Generation Per Year
energy %>% 
  filter(producer != "Total Electric Power Industry", state == "US-TOTAL", source != 'Total', year <= 2021) %>% 
  ggplot() + 
  geom_col(aes(x = year, y = generation, fill = source)) +
  labs(title = "US Power Generation Per Year")

#Total US power distribution over months
energy %>% 
  filter(producer == "Total Electric Power Industry", state == 'US-TOTAL', source == 'Total') %>% 
  ggplot(aes(group = month, x = month, y = generation, fill = month))+
  geom_boxplot() +
  scale_x_continuous(breaks = c(1:12))


#TX power distribution over months
energy %>% 
  filter(producer == "Total Electric Power Industry", state == 'TX', source == 'Total') %>% 
  ggplot(aes(group = month, x = month, y = generation, fill = month))+
  geom_boxplot() +
  scale_x_continuous(breaks = c(1:12))+
  labs(title = 'TX Power Distribution Over Months')

energy %>% 
  filter(producer != "Total Electric Power Industry", state == 'TX', source != 'Total') %>% 
  ggplot()+
  geom_col(aes(x = month, y = generation, fill = source)) +
  labs(title = 'Texas Monthly Power Distribution Per Month')+
  scale_x_continuous(breaks = c(1:12))
```
#What we can derive from this graph is )___ observations: 1) our total energy 
```{r}
energy %>% 
  filter(producer != "Total Electric Power Industry", state == "US-TOTAL", source != 'Total', year <= 2021) %>% 
  ggplot() + 
  geom_col(aes(x = year, y = generation, fill = source)) +
  labs(title = "US Power Generation Per Year")


energy %>% 
  filter(producer == "Electric Generators, Electric Utilities", state == "US-TOTAL", year <=2021) %>% 
  ggplot() + 
  geom_col(aes(x = year, y = generation, fill = source)) +
  labs(title = "US Electric Generators, Electric Utilities Generation Per Year")
```

```{r}
energy %>% 
  filter(producer == "Electric Generators, Electric Utilities", state == "US-TOTAL") %>% 
  ggplot() + 
  geom_col(aes(x = year, y = generation, fill = source)) +
  labs(title = "US total power generation per year")
```

Source Percentage Per Producer Type
```{r}
energy %>% 
  filter(source == 'Coal', producer != "Total Electric Power Industry") %>% 
  ggplot() + 
  geom_col(aes(x = producer, y = generation, fill = producer)) +
  labs(title = "bfdsa")+
  theme(axis.text.x = element_text(angle = -25, vjust = 1, hjust = .1))

energy %>% 
  filter(source == 'Nuclear', producer != "Total Electric Power Industry") %>% 
  ggplot() + 
  geom_col(aes(x = producer, y = generation, fill = producer)) +
  labs(title = "bfdsa")+
  theme(axis.text.x = element_text(angle = -25, vjust = 1, hjust = .1))

energy %>% 
  filter(source == 'Petroleum', producer != "Total Electric Power Industry") %>% 
  ggplot() + 
  geom_col(aes(x = producer, y = generation, fill = producer)) +
  labs(title = "bfdsa")+
  theme(axis.text.x = element_text(angle = -25, vjust = 1, hjust = .1))

energy %>% 
  filter(source == 'Coal', producer != "Total Electric Power Industry") %>% 
  ggplot() + 
  geom_col(aes(x = producer, y = generation, fill = producer)) +
  labs(title = "bfdsa")+
  theme(axis.text.x = element_text(angle = -25, vjust = 1, hjust = .1))

energy %>% 
  group_by(source, producer) %>% 
  filter(source != 'Total', year == 2020) %>% 
  ggplot() + 
  geom_col(aes(x = producer, y = generation, fill = source)) +
  labs(title = "US Energy Sources Among Producer Types in 2020")+
  theme(axis.text.x = element_text(angle = -15, vjust = 1, hjust = .1))

energy %>% 
  group_by(source, producer, state) %>% 
  filter(source != 'Total', year == 2020, state == "TX") %>% 
  ggplot() + 
  geom_col(aes(x = producer, y = generation, fill = source)) +
  labs(title = "TX Energy Sources Among Producer Types in 2020")+
  theme(axis.text.x = element_text(angle = -15, vjust = 1, hjust = .1))

energy %>% 
  group_by(source, producer) %>% 
  filter(source != 'Total', year == 2001) %>% 
  ggplot() + 
  geom_col(aes(x = producer, y = generation, fill = source)) +
  labs(title = "bfdsa")+
  theme(axis.text.x = element_text(angle = -15, vjust = 1, hjust = .1))
```

