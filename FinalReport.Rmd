---
title: "Data2401Final"
author: "Kevin Sheard"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(ggplot2)
library(plotly)
```

```{r}
energy = read_csv("archive/organised_Gen.csv")

```


```{r}
colnames(energy) = c("ID", "year", "month", "state", "producer", "source", "generation")
energy = energy %>% select(-`ID`)
```


```{r}
energy %>% 
  filter(producer == "Total Electric Power Industry", state == "US-TOTAL") %>% 
  ggplot() + 
  geom_point(aes(x = year, y = generation, color = source)) +
  geom_smooth(aes(x = year, y = generation, color = source)) +
  labs(title = "US total power generation per year")
  
```
```{r}
energy %>% 
  filter(producer == "Total Electric Power Industry", state == "TX") %>% 
  ggplot() + 
  geom_point(aes(x = year, y = generation, color = source)) +
  geom_smooth(aes(x = year, y = generation, color = source)) +
  labs(title = "Texas total power generation per year")
```



```{r}
energy %>% 
  filter(producer == "Total Electric Power Industry", state != "US-TOTAL") %>% 
  ggplot() +
  geom_point(aes(x = state, y = generation, color = source))
```
```{r}
energy %>% 
  filter(producer == "Total Electric Power Industry", state != "US-TOTAL", generation < -5000) %>% 
  ggplot() +
  geom_point(aes(x = state, y = generation, color = source)) +
  labs(title = "States with negative power generation (<-5000)")
```

```{r}
energy %>% 
  filter(producer == "Total Electric Power Industry", state == "TX") %>% 
  ggplot() + 
  geom_point(aes(x = month, y = generation, color = source)) +
  geom_smooth(aes(x = month, y = generation, color = source)) +
  labs(title = "Texas total power generation per month")
```

```{r}
energy %>% 
  ggplot() +
  geom_col(aes(x = year, y = generation, fill = source)) +
  facet_wrap(vars(source))
  
```



US goal is to install an average of 30 GW of solar capacity per
year between now and 2025 and 60 GW per year from 2025-2030.
https://www.renewable-ei.org/pdfdownload/activities/01_Key_AlejandroMoreno.pdf


```{r}
total_energy = energy %>% filter(producer == "Total Electric Power Industry", state != "US-TOTAL") 
fig = energy %>% 
  filter(producer == "Total Electric Power Industry", state != "US-TOTAL") %>% 
  group_by(year, month, state) %>% 
  summarize(total = sum(generation)/2) %>% 
  right_join(total_energy) %>%
  filter(source != "Total") %>% 
  ggplot() +
  geom_col(aes(x = state, y = generation, fill = source))

ggplotly(fig, tooltip = "y")
```

```{r}
energy %>% filter(producer == "Total Electric Power Industry", state != "US-TOTAL", source != "Total") %>% 
  group_by(year, month)
```

